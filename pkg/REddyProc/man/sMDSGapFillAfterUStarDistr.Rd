\name{sMDSGapFillAfterUStarDistr}
\alias{sMDSGapFillAfterUStarDistr}
\title{GapFilling for several filters of estimated friction velocity Ustar thresholds.}
\description{sEddyProc$sMDSGapFillUStarDistr - calling \code{\link{sMDSGapFillAfterUstar}} for several filters of friction velocity Ustar}
\usage{sMDSGapFillAfterUStarDistr(FluxVar.s = "NEE", UstarVar.s = "Ustar", 
    UstarThres.df, seasonFactor.v, UstarSuffix.V.s = colnames(UstarThres.df)[-1], 
    ...)}
\arguments{
  \item{FluxVar.s}{Variable, i.e. collumn name,  of net ecosystem fluxes, default 'NEE'}
  \item{UstarVar.s}{Column name of friction velocity u* (ms-1), default 'Ustar'}
  \item{UstarThres.df}{data.frame with first column, season names, and remaining columns different estimates of uStar Threshold.
If the data.frame has only one row, then each uStar threshold estimate is applied to the entire dataset. 
Entries in first column must match levels in argument \code{seasonFactor.v}}
  \item{seasonFactor.v}{factor for subsetting time into seasons, should be the same as in the uStarThreshold estimation,
e.g. \code{createSeasonFactorMonth(sDATA$sDateTime)}}
  \item{UstarSuffix.V.s}{String vector
to distinguish result columns for different ustar values.
Its length must correspond to column numbers in \code{UstarThres.m.n}.}
  \item{\dots}{other arguments to \code{\link{sMDSGapFillAfterUstar}} and \code{\link{sMDSGapFill}}}
}
\details{The eddy covariance method does not work with low turbulence conditions. Hence the periods with low turbulence
indicated by a low friction velocity u* needs to be filtered out and gapfilled (see \code{\link{sMDSGapFill}}.
The threshold value of a sufficient u* causes one of the largest uncertainty components within the gap-filled data. 
Hence, it is good practice to compare derived quantities based on gap-filled data using different u* threshold values.

For example a user could provide the the following collumns in argument \code{UstarThres.df} 
and corresponding suffixes in argument \code{UstarSuffix.V.s}  
\itemize{
\item season: identifier for which season this row is used.
\item Ustar: estimate on original series
\item U05: 5\% of bootstrap
\item U50: median of bootstrap
\item U95: 95\% of bootstrap) 
} 
Then the difference between output columns NEE_U05_f and NEE_U95_f corresponds to the uncertainty
introduced by the uncertain estimate of the u* threshold.}
\value{Matrix (columns correspond to u*Scenarios) with quality flag from filtering ustar (0 - good data, 1 - filtered data)

Gap filling results in sTEMP data frame (with renamed columns), that can be retrieved by \code{\link{sExportResults}}.
Each of the columns is calculated for several u*r-estimates and distinguished by a suffix after the variable. 
E.g. with an first entry "U05" in \code{UstarSuffix.V.s} corresponding to the first column in  \code{UstarThres.m.n}, 
the corresponding filled NEE can be found in output collumn "NEE_U05_f".}

\author{TW
(Department for Biogeochemical Integration at MPI-BGC, Jena, Germany)}



\seealso{Advanced Example 1b in \code{\link{sEddyProc.example}}}

